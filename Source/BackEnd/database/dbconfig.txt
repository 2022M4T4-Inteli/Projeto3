SET check_function_bodies = false;

CREATE TABLE "manager"(
  manager_id serial NOT NULL,
  manager_name varchar(255) NOT NULL,
  email varchar(255) NOT NULL UNIQUE,
  "password" varchar(255) NOT NULL,
  CONSTRAINT "Manager_pkey" PRIMARY KEY(manager_id)
);

CREATE TABLE "vallet"(
  vallet_id serial NOT NULL UNIQUE,
  rfid_code varchar(255) NOT NULL,
  vallet_name varchar(255) NOT NULL,
  fk_manager_id integer NOT NULL,
  CONSTRAINT "Vallet_pkey" PRIMARY KEY(rfid_code)
);

CREATE TABLE "services"(
  service_id serial NOT NULL,
  estimate_time float NOT NULL,
  distance float NOT NULL,
  prism integer NOT NULL,
  status integer NOT NULL DEFAULT 0,
  fk_rfid_code varchar(255) NOT NULL,
  CONSTRAINT services_pkey PRIMARY KEY(service_id)
);

ALTER TABLE "vallet"
  ADD CONSTRAINT "vallet_fk_manager_id_fkey"
    FOREIGN KEY (fk_manager_id) REFERENCES "manager" (manager_id);

ALTER TABLE "services"
  ADD CONSTRAINT "services_fk_rfid_code_fkey"
    FOREIGN KEY (fk_rfid_code) REFERENCES "vallet" (rfid_code);
